<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lesson 23: Inference for Bivariate Data</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Math 221</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Unit 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lesson01_Campus.html">Lesson 1: (On Campus) Course Intro &amp; Probability</a>
    </li>
    <li>
      <a href="Lesson01.html">Lesson 1: (Online) Course Intro &amp; Probability</a>
    </li>
    <li>
      <a href="Lesson02.html">Lesson 2: The Statistical Process</a>
    </li>
    <li>
      <a href="Lesson03.html">Lesson 3: Describing Quantitative Data (Shape &amp; Center)</a>
    </li>
    <li>
      <a href="Lesson04.html">Lesson 4: Describing Quantitative Data (Spread)</a>
    </li>
    <li>
      <a href="Lesson05.html">Lesson 5: Normal Distributions</a>
    </li>
    <li>
      <a href="Lesson06.html">Lesson 6: The Central Limit Theorem</a>
    </li>
    <li>
      <a href="Lesson07.html">Lesson 7: Calculating Probabilities involving the Sample Mean</a>
    </li>
    <li>
      <a href="Lesson08.html">Lesson 8: Unit 1 Review</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Unit 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lesson09.html">Lesson 9: Hypothesis Test for One Mean (Sigma Known)</a>
    </li>
    <li>
      <a href="Lesson10.html">Lesson 10: Confidence Interval for One Mean (Sigma Known)</a>
    </li>
    <li>
      <a href="Lesson11.html">Lesson 11: Inference for One Mean (Sigma Unknown)</a>
    </li>
    <li>
      <a href="Lesson12.html">Lesson 12: Inference for Match Pairs</a>
    </li>
    <li>
      <a href="Lesson13.html">Lesson 13: Inference for Two Independent Samples</a>
    </li>
    <li>
      <a href="Lesson14.html">Lesson 14: Inference for Several Independent Samples</a>
    </li>
    <li>
      <a href="Lesson15.html">Lesson 15: Unit 2 Review</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Unit 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lesson16.html">Lesson 16: Describing Categorical Data</a>
    </li>
    <li>
      <a href="Lesson17.html">Lesson 17: Inference for One Proportion</a>
    </li>
    <li>
      <a href="Lesson18.html">Lesson 18: Inference for Two Proportions</a>
    </li>
    <li>
      <a href="Lesson19.html">Lesson 19: Inference for Independence of Categorical Data</a>
    </li>
    <li>
      <a href="Lesson20.html">Lesson 20: Unit 3 Review</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Unit 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lesson21.html">Lesson 21: Describing Bivariate Data</a>
    </li>
    <li>
      <a href="Lesson22.html">Lesson 22: Simple Linear Regression</a>
    </li>
    <li>
      <a href="Lesson23.html">Lesson 23: Inference for Bivariate Data</a>
    </li>
    <li>
      <a href="Lesson24.html">Lesson 24: Unit 4 Review</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="RHelp.html">R Help</a>
</li>
<li>
  <a href="Data.html">Data</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lesson 23: Inference for Bivariate Data</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#lesson-outcomes">Lesson Outcomes</a></li>
<li><a href="#theory-of-simple-linear-regression">Theory of Simple Linear Regression</a></li>
<li><a href="#checking-requirements-of-simple-linear-regression">Checking Requirements of Simple Linear Regression</a>
<ul>
<li><a href="#scatterplot">Scatterplot</a></li>
<li><a href="#residuals">Residuals</a></li>
<li><a href="#r-instructions-for-computing-residuals">R Instructions for Computing Residuals</a></li>
<li><a href="#residual-plot">Residual Plot</a></li>
<li><a href="#r-instructions-for-residual-plots">R Instructions for Residual Plots</a></li>
<li><a href="#histogram-of-the-residuals">Histogram of the Residuals</a></li>
<li><a href="#requirements-summary">Requirements Summary</a></li>
</ul></li>
<li><a href="#hypothesis-test-for-regression-coefficients">Hypothesis Test for Regression Coefficients</a>
<ul>
<li><a href="#estuarine-crocodiles">Estuarine Crocodiles</a></li>
<li><a href="#r-instructions-for-testing-the-regression-slope">R Instructions for Testing the Regression Slope</a></li>
<li><a href="#manatees">Manatees</a></li>
</ul></li>
<li><a href="#confidence-intervals-for-regression-coefficients">Confidence Intervals for Regression Coefficients</a>
<ul>
<li><a href="#manatees-1">Manatees</a></li>
<li><a href="#r-instructions-for-confidence-intervals">R Instructions for Confidence Intervals</a></li>
<li><a href="#estuarine-crocodiles-1">Estuarine Crocodiles</a></li>
</ul></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#navigation">Navigation</a></li>
</ul>
</div>

<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>
<div style="float:right;width=40%;">
<br/>
<div style="padding-left:10%;">
<strong>Optional Lesson Video</strong>
</div>
<iframe width="90%" align="right" src="https://www.youtube.com/embed/videoseries?list=PLaZryQtbPQC8-A6W3DcLXUyoR8x0dpTgs" frameborder="1" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
<p><br></p>
<div id="lesson-outcomes" class="section level2">
<h2>Lesson Outcomes</h2>
<a href="javascript:showhide('oc')"><span style="font-size:8pt;">Show/Hide Outcomes</span></a>
<div id="oc" style="display:none;">
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Confidence Intervals for the slope of the regression line:
<ul>
<li>Calculate and interpret a confidence interval for the slope of the regression line given a confidence level.</li>
<li>Identify a point estimate and margin of error for the confidence interval.</li>
<li>Show the appropriate connections between the numerical and graphical summaries that support the confidence interval.</li>
<li>Check the requirements for the confidence interval.</li>
</ul></li>
<li>Hypothesis Testing for the slope of the regression line:
<ul>
<li>State the null and alternative hypothesis.</li>
<li>Calculate the test-statistic, degrees of freedom and p-value of the hypothesis test.</li>
<li>Assess the statistical significance by comparing the p-value to the α-level.</li>
<li>Check the requirements for the hypothesis test.</li>
<li>Show the appropriate connections between the numerical and graphical summaries that support the hypothesis test.</li>
<li>Draw a correct conclusion for the hypothesis test.</li>
</ul></li>
</ul>
</div>
<p><br></p>
</div>
<div id="theory-of-simple-linear-regression" class="section level2">
<h2>Theory of Simple Linear Regression</h2>
<p><img src="Images/Line_on_coordinate_plane.jpg"></p>
<p>When we compute an estimated regression equation, we assume that there is some true equation that describes the relationship between the <span class="math inline">\(X\)</span>-variable and the mean value of <span class="math inline">\(Y\)</span>. This equation is unknown to us. In particular, we don’t know what the coefficients are in this equation. In the estimated regression equation, we used <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to represent the <span class="math inline">\(Y\)</span>-intercept and slope, respectively. These two coefficients are estimates of the unknown regression coefficients in the true equation. We will use the Greek letter <span class="math inline">\(\beta\)</span> (pronounced “beta”) to denote these true unknown coefficients.</p>
<p>The true regression line is written as: <span class="math display">\[
\textrm{Expected value of }~Y = \beta_0 + \beta_1 X
\]</span> where <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are parameters. These are unknown constants representing the true values for the population.</p>
<p>We know that <span class="math inline">\(Y\)</span> will not fall exactly on this line. There will be some randomness in the observed values of <span class="math inline">\(Y\)</span>. So, we add a term, called the <em>error term</em>, to this equation. This is a random variable, and we denote it by the Greek letter <span class="math inline">\(\epsilon\)</span> (pronounced “epsilon”.) The true regression equation is: <span class="math display">\[
Y = \beta_0 + \beta_1 X + \epsilon
\]</span> where <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are parameters, and <span class="math inline">\(\epsilon\)</span> is a (normal) random variable.</p>
</div>
<div id="checking-requirements-of-simple-linear-regression" class="section level2">
<h2>Checking Requirements of Simple Linear Regression</h2>
<p>In order to do hypothesis tests and confidence intervals using a regression line, we need to be sure that certain conditions are satisfied. There are five requirements for a linear regression model:</p>
<ol style="list-style-type: decimal">
<li><span id='linear'><span> There is a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</li>
<li><span id='normal'><span> The error term (<span class="math inline">\(\epsilon\)</span>) is normally distributed.</li>
<li><span id='const'><span> The variance of the error terms is constant for all values of <span class="math inline">\(X\)</span>.</li>
<li><span id='fixed'><span> The <span class="math inline">\(X\)</span>’s are fixed and measured without error. (In other words, the <span class="math inline">\(X\)</span>’s can be considered as known constants.)</li>
<li><span id='indep'><span> The observations are independent.</li>
</ol>
<p>These must be satisfied in order to conduct a hypothesis test or create confidence intervals involving regression lines.</p>
<p>We will illustrate the process of checking requirements using the estuarine crocodile data.</p>
<div id="scatterplot" class="section level3">
<h3>Scatterplot</h3>
<p>To check requirement 1, we do two things. The first is to make a scatterplot and to visually check to see if there is a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. This has been referred to as a “hot dog” shape in the data.</p>
<p>We want to make sure that there is no distinct curvature or other nonlinear characteristics. This is simply a visual check of the data.</p>
<p>Consider the scatterplot of the estuarine crocodile data <a href="./Data/Estuarine_Crocodile.xlsx">EstuarineCrocodile.xlsx</a>:</p>
<p><img src="Images/EstuarineCrocodile-Scatterplot-RegLine-Excel.PNG"></p>
<p>Notice how the data follow a linear shape. This data set shows a particularly strong linear relationship. In many cases, the data will show more spread than is illustrated here.</p>
</div>
<div id="residuals" class="section level3">
<h3>Residuals</h3>
<p>The <em>residual</em> for an observation is defined as the difference between the observed value of <span class="math inline">\(Y\)</span> and the value that would have been predicted by the regression line. As an equation, this is expressed as: <span class="math display">\[
Residual = Y - \hat Y = Y - (b_0 + b_1 X)
\]</span></p>
<p>It is tedious to calculate the residuals by hand, but software can be used to find the residuals.</p>
</div>
<div id="r-instructions-for-computing-residuals" class="section level3">
<h3>R Instructions for Computing Residuals</h3>
<div class="SoftwareHeading">
R Instructions
</div>
<div class="Software">
<p><strong>To find the residuals in R, do the following:</strong></p>
<ul>
<li>Read the data into R: <a href="./Data/Estuarine_Crocodile.xlsx">EstuarineCrocodile.xlsx</a></li>
<li>Perform a linear regression using the <code>lm( )</code> function.</li>
</ul>
<pre class="r"><code>estuarine.lm &lt;- lm(EstuarineCrocodiles$BodyLength ~ EstuarineCrocodiles$HeadLength)</code></pre>
<ul>
<li>Use the name of the lm that you created and the <code>$</code> to access the residuals.</li>
</ul>
<pre class="r"><code>estuarine.lm$residuals</code></pre>
<pre><code>##           1           2           3           4           5           6 
##  -4.5684826  13.4315174  -0.8493199   9.1703661  -1.1301573  11.8698427 
##           7           8           9          10          11          12 
##   7.9092147 -16.4109947  25.9485867  10.0076446   3.6086913 -15.3716227 
##          13          14          15          16          17          18 
##  -7.8099479  14.9092147  -8.8099479   0.9289007  -4.4700526  -1.0710993 
##          19          20          21          22          23          24 
## -18.1301573   4.2884820  -6.9923554 -10.7115180   3.2294240  -5.3716227 
##          25          26          27          28 
##  12.2687960   0.6480633 -12.1301573  -4.3913087</code></pre>
<p>Each residual is labeled as residual #1, #2, #3, and so on, in this case up to residual #28. These correspond to the order of the original data set.</p>
<p><br></p>
</div>
<p><br></p>
</div>
<div id="residual-plot" class="section level3">
<h3>Residual Plot</h3>
<p>The residual is calculated for each data point, so you have one residual for every observation in the data set. It is hard to use so many numbers to make decisions. How do you comprehend so much information at once? To help us understand the information in the residuals, we make what is called a <em>residual plot</em>. A residual plot is a scatterplot where the <span class="math inline">\(X\)</span>-axis shows the independent variable (<span class="math inline">\(X\)</span>) and the <span class="math inline">\(Y\)</span>-axis presents the residuals for each value of <span class="math inline">\(X\)</span>.</p>
</div>
<div id="r-instructions-for-residual-plots" class="section level3">
<h3>R Instructions for Residual Plots</h3>
<div class="SoftwareHeading">
Excel Instructions
</div>
<div class="Software">
<ul>
<li>Read the data into R: <a href="./Data/Estuarine_Crocodile.xlsx">EstuarineCrocodile.xlsx</a></li>
<li>Perform a linear regression using the <code>lm( )</code> function.</li>
</ul>
<pre class="r"><code>estuarine.lm &lt;- lm(EstuarineCrocodiles$BodyLength ~ EstuarineCrocodiles$HeadLength)</code></pre>
<ul>
<li>Use the name of the lm that you created and the <code>plot()</code> function to create the residual plot. There are 4 plots that are created by default. The residuals vs. fitted-values plot is the first, so use <code>plot(  , which=1)</code> to obtain just the first plot.</li>
</ul>
<pre class="r"><code>plot(estuarine.lm, which=1)</code></pre>
<p><img src="Lesson23_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The red line is often not helpful in this plot, but should be relatively flat. Only trust the red line when the dots in the graph seem to closely follow the red line. If the red line just looks chaotic, don’t worry about whether or not it is flat.</p>
<p><br></p>
</div>
<p><br></p>
<p>The residual plot of the estuarine crocodile data shown above shows random scatter. There is no obvious pattern in the data. This is good. Whenever linear regression is appropriate, then the residual plot will show no patterns and will consist of random scatter. If there is a pattern in the residuals, it suggests that linear regression is not appropriate.</p>
<p>There are several patterns that could arise in a residual plot:</p>
<ul>
<li><strong>Curvature</strong> If the residual plot shows curvature, that suggests that the data are not linearly related.</li>
</ul>
<div style="padding-left:30px;">
<p><img src="Lesson23_files/figure-html/unnamed-chunk-7-1.png" width="288" /></p>
</div>
<ul>
<li><strong>Megaphone</strong> A megaphone shape occurs when points tend to be close together on one side of the graph and farther apart on the other side of the graph. If there is a megaphone shape apparent in the residuals, it suggests that the variance of the error terms is not constant for all values of <span class="math inline">\(X\)</span>. It suggests that there is a difference in the spread of the residuals depending on the value of <span class="math inline">\(X\)</span>.</li>
</ul>
<div style="padding-left:30px;">
<p><img src="Lesson23_files/figure-html/unnamed-chunk-8-1.png" width="288" /></p>
</div>
<ul>
<li><strong>Outliers</strong> If there are outliers in the residual plot, that suggests that the error terms are not normally distributed. This should also be apparent in the scatterplot or histogram of the residuals.</li>
</ul>
<div style="padding-left:30px;">
<p><img src="Lesson23_files/figure-html/unnamed-chunk-9-1.png" width="288" /></p>
</div>
<p><br/></p>
</div>
<div id="histogram-of-the-residuals" class="section level3">
<h3>Histogram of the Residuals</h3>
<p>Once the residuals have been calculated in R, we can assess if they are normally distributed using a histogram. If the shape of the histogram of residuals does not show a distinct departure from a normal shape, we conclude the requirement of normal residuals has been met.</p>
<pre class="r"><code>hist(estuarine.lm$residuals)</code></pre>
<p><img src="Lesson23_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The histogram of the residuals using 7 bins does not show a distinct or extreme departure from a normal shape. We do not have evidence of nonnormality in the residuals. We conclude that the residuals are normally distributed. In more advanced classes you will use a tool called a Q-Q plot to assess whether residuals are normally distributed.</p>
</div>
<div id="requirements-summary" class="section level3">
<h3>Requirements Summary</h3>
<p>The following table describes how to check each of the requirements above.</p>
<table>
<thead>
<tr class="header">
<th>
</th>
<th>
<p>
Requirement
</p>
</th>
<th>
<p>
How to Check
</p>
</th>
<th>
<p>
What you hope to see
</p>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
1.
</p>
</td>
<td>
<p>
Linear Relationship
</p>
</td>
<td>
<p>
Scatterplot
</p>
</td>
<td>
<p>
“Hot dog” shape
</p>
</td>
</tr>
<tr class="even">
<td>
</td>
<td>
</td>
<td>
<p>
Residual Plot
</p>
</td>
<td>
<p>
No pattern in the residuals
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
2.
</p>
</td>
<td>
<p>
Normal Error Term
</p>
</td>
<td>
<p>
Histogram of the Residuals
</p>
</td>
<td>
<p>
A shape that is approximately normal
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
3.
</p>
</td>
<td>
<p>
Constant Variance
</p>
</td>
<td>
<p>
Residual Plot
</p>
</td>
<td>
<p>
No megaphone shape in the residuals
</p>
</td>
</tr>
<tr class="odd">
<td>
<p>
4.
</p>
</td>
<td>
<p>
<span class="math inline">\(X\)</span>’s are Known<br /> Constants
</p>
</td>
<td>
<p>
Cannot be checked directly
</p>
</td>
<td>
<p>
<span class="math inline">\(X\)</span>’s should be measured<br /> accurately and precisely
</p>
</td>
</tr>
<tr class="even">
<td>
<p>
5.
</p>
</td>
<td>
<p>
Observations are<br /> Independent
</p>
</td>
<td>
<p>
Cannot be checked directly
</p>
</td>
<td>
<p>
Knowing the value of one of the <span class="math inline">\(Y\)</span>’s<br /> tells you nothing about any other points
</p>
</td>
</tr>
<tr class="odd">
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody>
</table>
<p>If these requirements are met, then it is reasonable to assume that the use of regression with the data is appropriate.</p>
</div>
</div>
<div id="hypothesis-test-for-regression-coefficients" class="section level2">
<h2>Hypothesis Test for Regression Coefficients</h2>
<p><img src="Images/Step4.png"></p>
<div id="estuarine-crocodiles" class="section level3">
<h3>Estuarine Crocodiles</h3>
<p>We want to know if there is a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. To test for this, we need to determine if the slope is different from zero. If the slope is zero, then that suggests that there is no linear relationship between the two variables. If the slope is not zero, that suggests that there is a linear relationship between the two variables.</p>
<p>In this course, we will test if the true slope is different from zero. If the slope equals zero, <span class="math inline">\(\beta_1 = 0\)</span>, then the regression line reduces from: <span class="math display">\[Y = \beta_0 + \beta_1 X + \epsilon\]</span></p>
<p>to: <span class="math display">\[Y = \beta_0 + 0 \cdot X_i + \epsilon = \beta_0 + \epsilon_i\]</span></p>
<p>In other words, the independent variable <span class="math inline">\(X\)</span> does not affect the value of the dependent variable <span class="math inline">\(Y\)</span>.</p>
<p>The null and alternative hypotheses for this test are: <span class="math display">\[
\begin{array}{ll}
H_0: &amp; \beta_1  =  0\\
H_a: &amp; \beta_1 \ne 0\\
\end{array}
\]</span></p>
<p>We will assume the <span class="math inline">\(0.05\)</span> level of significance.</p>
<p>The relevant summary statistics include the sample size and the estimated regression equation (<span class="math inline">\(\hat Y = b_0 + b_1 X\)</span>). For the estuarine crocodile data, we get the following.</p>
</div>
<div id="r-instructions-for-testing-the-regression-slope" class="section level3">
<h3>R Instructions for Testing the Regression Slope</h3>
<div class="SoftwareHeading">
Excel Instructions
</div>
<div class="Software">
<ul>
<li>Read the data into R: <a href="./Data/Estuarine_Crocodile.xlsx">EstuarineCrocodile.xlsx</a></li>
<li>Perform a linear regression using the <code>lm( )</code> function.</li>
<li>See the results using <code>summary( )</code>.</li>
</ul>
<pre class="r"><code>estuarine.lm &lt;- lm(EstuarineCrocodiles$BodyLength ~ EstuarineCrocodiles$HeadLength)
summary(estuarine.lm)</code></pre>
<pre><code>
Call:
lm(formula = EstuarineCrocodiles$BodyLength ~ EstuarineCrocodiles$HeadLength)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.1302  -7.1968  -0.9602   8.2245  25.9486 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -18.2740     9.9663  -1.834   0.0782 .  
EstuarineCrocodiles$HeadLength   7.6601     0.2152  35.588   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 10.8 on 26 degrees of freedom
Multiple R-squared:  0.9799,    Adjusted R-squared:  0.9791 
F-statistic:  1267 on 1 and 26 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><br/></p>
</div>
<p><br/></p>
<p>The output above shows that</p>
<p><span class="math display">\[
\begin{array}{c}
n=28 \\
\hat Y = -18.274 + 7.660 X \\
\end{array}
\]</span></p>
<p>The test statistic follows a <span class="math inline">\(t\)</span>-distribution. We are conducting a test for the slope. The information related to the slope is given in the second row of the “Estimate” table, which is labeled “EstuarineCrocodiles$HeadLength”. Looking across the second row, we find the value of <span class="math inline">\(t\)</span> is given as 35.588. <span class="math display">\[
t=35.588
\]</span></p>
<p>This is a tremendously large value for t. This indicates that there is a lot of evidence against the null hypothesis.</p>
<p>Remember, the <span class="math inline">\(t\)</span> distribution has one number describing its degrees of freedom. The degrees of freedom for this test is shown towards the bottom of the output where it states “26 degrees of freedom”. It is also easy to calculate the degrees of freedom by hand. Because we used the dataset to estimate two population parameters (a slope and a y-intercept) we have used two degrees of freedom. There are 28 observations in our dataset. The degrees of freedom equals <span class="math inline">\(28-2 = 26\)</span> for the estuarine crocodile data. <span class="math display">\[
df= 28-2 = 26
\]</span></p>
<p>With a test statistic of <span class="math inline">\(t=35.588\)</span>, we get a very small <span class="math inline">\(P\)</span>-value, “0.000” as shown in the column of the output titled “Pr(&gt;|t|)”. That stands for “the probability” (Pr) of being “more extreme” (&gt;) than the observed test statistic (t).</p>
<p>Assuming <span class="math inline">\(\alpha=0.05\)</span>, we reject the null hypothesis since the <span class="math inline">\(P\)</span>-value is less than the level of significance. There is sufficient evidence to suggest that there is a linear relationship between the head length and the body length of estuarine crocodiles.</p>
<p>It was appropriate to conduct this analysis, since the requirements of simple linear regression were satisfied.</p>
</div>
<div id="manatees" class="section level3">
<h3>Manatees</h3>
<p><img src="Images/Step4.png"></p>
<p>Here is an excerpt from the output for the <a href="./Data/Manatees.xlsx">Manatees.xlsx</a> data set:</p>
<table style="width:51%;">
<colgroup>
<col width="36%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Power Boats (in 1000’s)</th>
<th align="center">Manatees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">436</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="center">449</td>
<td align="center">21</td>
</tr>
<tr class="odd">
<td align="center">470</td>
<td align="center">18</td>
</tr>
<tr class="even">
<td align="center">487</td>
<td align="center">19</td>
</tr>
<tr class="odd">
<td align="center">502</td>
<td align="center">24</td>
</tr>
<tr class="even">
<td align="center">501</td>
<td align="center">18</td>
</tr>
</tbody>
</table>
<p>The null and alternative hypotheses for this test are: <span class="math display">\[
\begin{array}{ll}
H_0: &amp; \beta_1  =  0\\
H_a: &amp; \beta_1 \ne 0\\
\end{array}
\]</span></p>
<p>The relevant summary statistics include the sample size and the estimated regression equation (<span class="math inline">\(\hat Y = b_0 + b_1 X\)</span>). <span class="math display">\[
\begin{array}{c}
n=35 \\
\hat Y = -42.542 + 0.129 X \\
\end{array}
\]</span></p>
<p>The test statistic follows a <span class="math inline">\(t\)</span>-distribution.</p>
<pre class="r"><code>manatee.lm &lt;- lm(Manatees$Manatees ~ Manatees$`Power Boats (in 1000&#39;s)`)
summary(manatee.lm)</code></pre>
<pre><code>
Call:
lm(formula = Manatees$Manatees ~ Manatees$`Power Boats (in 1000&#39;s)`)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.758  -6.647  -1.239   4.349  22.344 

Coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        -42.541613   6.349634   -6.70 1.25e-07 ***
Manatees$`Power Boats (in 1000&#39;s)`   0.129162   0.008338   15.49  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 9.239 on 33 degrees of freedom
Multiple R-squared:  0.8791,    Adjusted R-squared:  0.8754 
F-statistic:   240 on 1 and 33 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Remember, we are conducting a test for the slope, so the information we need is given in the second row of output. We find the value of <span class="math inline">\(t\)</span> is given as 15.49. <span class="math display">\[
t=15.49
\]</span></p>
<p>Think about this result. Is this a large or a small value for <span class="math inline">\(t\)</span>? What does this say about the conclusion to our test?</p>
<p>Remember, the <span class="math inline">\(t\)</span> has one number describing its degrees of freedom. For this test, the degrees of freedom <span class="math inline">\(35-2 = 33\)</span>. We subtract two from the total number of observations because we estimated 2 population parameters for the line: a y-intercept and a slope.<br />
<span class="math display">\[
df=33
\]</span></p>
<p>With a test statistic of <span class="math inline">\(t=15.49\)</span> and <span class="math inline">\(33\)</span> degrees of freedom, we get a very small <span class="math inline">\(P\)</span>-value. The value is so small that when we round to just three decimal places, the <span class="math inline">\(P\)</span>-value appears to be zero. In the output the p-value is listed as “&lt;2e-16” which means it is so small that it is less than <span class="math inline">\(2\times10^{-16}\)</span>!</p>
<p>Assuming <span class="math inline">\(\alpha=0.05\)</span>, our decision rule is to reject the null hypothesis, since the <span class="math inline">\(P\)</span>-value is less than the level of significance. There is sufficient evidence to suggest that there is a linear relationship between the number of powerboats registered in Florida and the number of manatees killed by powerboats. This conclusion fits our intuition. If there are more boats on the water, it seems plausible that this will affect the number of manatees killed. If any statistical conclusion is counterintuitive, you should always be very wary!</p>
<p><br></p>
</div>
</div>
<div id="confidence-intervals-for-regression-coefficients" class="section level2">
<h2>Confidence Intervals for Regression Coefficients</h2>
<div id="manatees-1" class="section level3">
<h3>Manatees</h3>
<p>We are often interested in the range of plausible values for the true regression coefficients. We can create a confidence interval for the slope and the <span class="math inline">\(Y\)</span>-intercept in R.</p>
</div>
<div id="r-instructions-for-confidence-intervals" class="section level3">
<h3>R Instructions for Confidence Intervals</h3>
<div class="SoftwareHeading">
R Instructions
</div>
<div class="Software">
<p><strong>To compute the confidence intervals for the regression coefficients in R, do the following:</strong></p>
<ul>
<li>Read the data into R: <a href="./Data/Estuarine_Crocodile.xlsx">EstuarineCrocodile.xlsx</a></li>
<li>Perform a linear regression using the <code>lm( )</code> function.</li>
</ul>
<pre class="r"><code>manatee.lm &lt;- lm(Manatees$Manatees ~ Manatees$`Power Boats (in 1000&#39;s)`)</code></pre>
<ul>
<li>Use the <code>confint( )</code> function with the name of your lm object placed inside to obtain the confidence intervals. Use <code>confint(  , conf.level=0.95)</code> to control the confidence level.</li>
</ul>
<pre class="r"><code>confint(manatee.lm, level=0.95)</code></pre>
<pre><code>                                         2.5 %      97.5 %
(Intercept)                        -55.4600405 -29.6231851
Manatees$`Power Boats (in 1000&#39;s)`   0.1121986   0.1461254</code></pre>
<p>The first row of the output gives the confidence interval for <span class="math inline">\(\beta_0\)</span>, the y-intercept. The second row of the output gives the confidence interval for <span class="math inline">\(\beta_1\)</span>, the slope.</p>
<p><br></p>
</div>
<p><br></p>
<p>In this case, the 95% confidence interval for the true slope of the regression line relating the number of thousand powerboats registered in Florida to the number of manatees killed is <span class="math inline">\((0.112, 0.146)\)</span>. Remember the slope is the amount that <span class="math inline">\(Y\)</span> is expected to change if <span class="math inline">\(X\)</span> changes by one unit. Also, recall that <span class="math inline">\(X\)</span> is given in terms of thousands of powerboats registered. If an additional one thousand powerboats are registered (one unit increase in <span class="math inline">\(X\)</span>,) we are 95% confident that the average number of manatees killed in such years will increase between 0.112 and 0.146. Or in other words, if 100 thousand additional powerboats are registered in Florida, we expect the average number of manatee deaths witnessed in such years to be between 11.2 to 14.6 manatees.</p>
<p>The 95% confidence interval for the <span class="math inline">\(Y\)</span>-intercept is <span class="math inline">\((-55.460, -29.623)\)</span>. We are 95% confident that the expected number of manatees that will be killed if there are zero powerboats registered in Florida is between <span class="math inline">\(-55.5\)</span> and <span class="math inline">\(-29.6\)</span>. This is illogical. There cannot be a negative number of manatees killed. The <span class="math inline">\(Y\)</span>-intercept is not interpretable for this data.</p>
<p>Sometimes the <span class="math inline">\(Y\)</span>-intercept makes sense in the context of the problem, but in many cases it is just used to get the best fit for the regression equation.</p>
</div>
<div id="estuarine-crocodiles-1" class="section level3">
<h3>Estuarine Crocodiles</h3>
<p>We can compute a 95% confidence interval for the estuarine crocodile data in a similar manner.</p>
<div class="QuestionsHeading">
Answer the following questions:
</div>
<div class="Questions">
<ol style="list-style-type: decimal">
<li>Find a 95% confidence interval for the slope of the regression line relating the head lengths and body lengths of estuarine crocodiles.</li>
</ol>
<a href="javascript:showhide('Q1')"><span style="font-size:8pt;">Show/Hide Solution</span></a>
<div id="Q1" style="display:none;">
<pre class="r"><code>estuarine.lm &lt;- lm(EstuarineCrocodiles$BodyLength ~ EstuarineCrocodiles$HeadLength)
confint(estuarine.lm, level=0.95)</code></pre>
<pre><code>                                    2.5 %   97.5 %
(Intercept)                    -38.760103 2.212044
EstuarineCrocodiles$HeadLength   7.217669 8.102540</code></pre>
<center>
<span class="math display">\[
(7.218,~8.103)
\]</span>
</center>
</div>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Interpret the confidence interval you created in the previous problem.</li>
</ol>
<a href="javascript:showhide('Q2')"><span style="font-size:8pt;">Show/Hide Solution</span></a>
<div id="Q2" style="display:none;">
<ul>
<li>We are 95% confident that the true slope of the regression line relating the head length and the body length of estuarine crocodiles is between 7.218 and 8.103. So, we are 95% confident that if the length of the head increases by 1 cm, then the increase in the mean body length is expected to be between 7.218 and 8.103.</li>
</ul>
</div>
<p> </p>
</div>
<p><br></p>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<div class="SummaryHeading">
Remember…
</div>
<div class="Summary">
<ul>
<li><p>The unknown <strong>true linear regression line</strong> is <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> where <span class="math inline">\(\beta_0\)</span> is the true y-intercept of the line and <span class="math inline">\(\beta_1\)</span> is the true slope of the line.</p></li>
<li><p>A <strong>residual</strong> is the difference between the observed value of <span class="math inline">\(Y\)</span> for a given <span class="math inline">\(X\)</span> and the predicted value of <span class="math inline">\(Y\)</span> on the regression line for the same <span class="math inline">\(X\)</span>. It can be expressed as: <span class="math display">\[
Residual = Y - \hat Y = Y - (b_0 + b_1 X)
\]</span></p></li>
<li><p>Residuals can be obtained in R using <code>lmObjectName$residuals</code>, <a href="Lesson23.html#r-instructions-for-computing-residuals">see here</a> for details.</p></li>
<li><p>To check all the requirements for bivariate inference you will need to create a <strong>scatterplot</strong> of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, a <strong>residual plot</strong>, and a <strong>histogram of the residuals</strong>. These plots can be created in R using <code>plot(lmObjectName, which=1)</code> and <code>hist(lmObjectName$residuals)</code>, <a href="Lesson23.html#r-instructions-for-residual-plots">see here</a> for an example.</p></li>
<li><p>We conduct a hypothesis test on bivariate data to know if there is a linear relationship between the two variables. To determine this, we test the slope (<span class="math inline">\(\beta_1\)</span>) on whether or not it equals zero. The appropriate hypotheses for this test are: <span class="math display">\[
\begin{array}{1cl}
H_0: &amp; \beta_1=0 \\
H_a: &amp; \beta_1\ne0
\end{array}
\]</span></p></li>
<li><p>For bivariate inference we use R to calculate the sample coefficients, residuals, test statistic, <span class="math inline">\(P\)</span>-value, and confidence intervals of the true linear regression coefficients using <code>lm( )</code> and <code>summary( )</code> as <a href="Lesson23.html#r-instructions-for-testing-the-regression-slope">shown here</a>.</p></li>
<li><p>Confidence intervals for the true regression coefficients (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) can be computed by <code>confint( )</code> as <a href="Lesson23.html#r-instructions-for-confidence-intervals">shown here</a>. <br></p></li>
</ul>
</div>
<p><br></p>
</div>
<div id="navigation" class="section level2">
<h2>Navigation</h2>
<center>
<table>
<colgroup>
<col width="38%" />
<col width="30%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><strong>Previous Reading</strong></th>
<th align="center"><strong>This Reading</strong></th>
<th align="center"><strong>Next Reading</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><a href="Lesson22.html">Lesson 22: <br> Simple Linear Regression</a></td>
<td align="center">Lesson 23: <br> Inference for Bivariate Data</td>
<td align="center"><a href="Lesson24.html">Lesson 24: <br> Review for Exam 4</a></td>
</tr>
</tbody>
</table>
</center>
</div>

<br />
<hr />
<p>Copyright &copy; 2020 Brigham Young University-Idaho. All rights reserved.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
